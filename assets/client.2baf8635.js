import{_ as O,a as f,X as M,d as R,S as y,R as a,Y as S,u as g,n as C}from"./app.2b9af6ff.js";import{W as E,n as x,X as U,Y as I}from"./pages.c22eb3e2.js";var _=function(s){O(n,s);function n(r,e){var t;return t=s.call(this)||this,t.client=r,t.setOptions(e),t.bindMethods(),t.updateResult(),t}var u=n.prototype;return u.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},u.setOptions=function(e){this.options=this.client.defaultMutationOptions(e)},u.onUnsubscribe=function(){if(!this.listeners.length){var e;(e=this.currentMutation)==null||e.removeObserver(this)}},u.onMutationUpdate=function(e){this.updateResult();var t={listeners:!0};e.type==="success"?t.onSuccess=!0:e.type==="error"&&(t.onError=!0),this.notify(t)},u.getCurrentResult=function(){return this.currentResult},u.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},u.mutate=function(e,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,f({},this.options,{variables:typeof e!="undefined"?e:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},u.updateResult=function(){var e=this.currentMutation?this.currentMutation.state:M(),t=f({},e,{isLoading:e.status==="loading",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset});this.currentResult=t},u.notify=function(e){var t=this;R.batch(function(){t.mutateOptions&&(e.onSuccess?(t.mutateOptions.onSuccess==null||t.mutateOptions.onSuccess(t.currentResult.data,t.currentResult.variables,t.currentResult.context),t.mutateOptions.onSettled==null||t.mutateOptions.onSettled(t.currentResult.data,null,t.currentResult.variables,t.currentResult.context)):e.onError&&(t.mutateOptions.onError==null||t.mutateOptions.onError(t.currentResult.error,t.currentResult.variables,t.currentResult.context),t.mutateOptions.onSettled==null||t.mutateOptions.onSettled(void 0,t.currentResult.error,t.currentResult.variables,t.currentResult.context))),e.listeners&&t.listeners.forEach(function(c){c(t.currentResult)})})},n}(y);function k(s,n,u){var r=a.useRef(!1),e=a.useState(0),t=e[1],c=S(s,n,u),m=g(),i=a.useRef();i.current?i.current.setOptions(c):i.current=new _(m,c);var o=i.current.getCurrentResult();a.useEffect(function(){r.current=!0;var l=i.current.subscribe(R.batchCalls(function(){r.current&&t(function(d){return d+1})}));return function(){r.current=!1,l()}},[]);var b=a.useCallback(function(l,d){i.current.mutate(l,d).catch(C)},[]);if(o.error&&E(void 0,i.current.options.useErrorBoundary,[o.error]))throw o.error;return f({},o,{mutate:b,mutateAsync:o.mutate})}const h={production:"https://api.pylon.money/",develop:"https://api.dev.pylon.rocks/"},p=s=>s,v=s=>{var n;return console.error(s),Promise.resolve((n=s==null?void 0:s.response)!=null?n:{status:404})},q=(s={baseURL:L()})=>{const n=x.create(s);return n.interceptors.request.use(p,v),n.interceptors.response.use(p,v),n},L=()=>{const s=U(),{isProduction:n}=I(s);return n?h.production:h.develop};export{q as c,k as u};
